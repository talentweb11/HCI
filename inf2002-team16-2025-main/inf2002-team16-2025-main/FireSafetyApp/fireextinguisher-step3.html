<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fire Extinguisher Demo</title>
  <link rel="stylesheet" href="static/css/style.css">
  <style>
    /* ================================
       Nozzle and Fire Extinguisher
    ================================== */
    .nozzle-container {
      position: absolute;
      bottom: 195px;
      left: 110px;
      width: 0;
      height: 0;
      transform-origin: 0 0;
      z-index: 2;
    }

    .hose-segment {
      position: absolute;
      width: 100%;
      height: 14px;
      background-color: #222;
      border-radius: 7px;
      top: -7px;
    }

    .nozzle {
      position: absolute;
      right: -30px;
      top: -48px;
      width: 55px;
      transform: rotate(110deg);
    }

    /* ================================
       Spray / Smoke Effect
    ================================== */
    .spray-wrapper {
      position: absolute;
      top: -220px; 
      left: 75px;
      transform-origin: left center;
      transform: rotate(110deg);
      z-index: 1;
      pointer-events: none;
    }

    .spray {
      position: relative;
      width: 0;
      height: 0;
      border-top: 40px solid transparent;
      border-bottom: 40px solid transparent;
      border-left: 150px solid rgba(161, 156, 156, 0.8);
      filter: blur(4px);
      opacity: 0;
      transition: opacity 0.2s ease;
    }

    .spray.active {
      opacity: 1;
      animation: sprayPulse 0.3s infinite alternate;
    }

    @keyframes sprayPulse {
      0% { transform: scaleX(1) scaleY(1); opacity: 0.7; }
      100% { transform: scaleX(1.1) scaleY(1.05); opacity: 1; }
    }

    .handle-area {
      position: absolute;
      bottom: 200px; 
      left: 10px;
      width: 80px;
      height: 50px;
      cursor: pointer;
      z-index: 10;
    }

    .success-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(255,255,255,0.8);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 99;
    }

    .success-overlay.show {
      display: flex;
    }

    .success-stamp {
      width: 220px;
      opacity: 0;
      transform: scale(0.1) rotate(-10deg);
      transition: all 0.4s ease;
    }

    .success-stamp.stamped {
      opacity: 1;
      transform: scale(1) rotate(0deg);
    }
  </style>
</head>
<body>
  <div class="frame">
    <!-- Header -->
    <div data-include="header.html" data-title="Demo" data-subtitle="Step 3"></div>

    <!-- Main Content -->
    <div class="container-demo2">
      <h2>Squeeze and hold the lever</h2>

      <!-- Fire -->
      <img
        src="assests/images/equipments/fire.png"
        alt="Fire"
        style="position: absolute; top: 110px; left: 140px; width: 100px; z-index: 2;"
      />

      <!-- Dustbin -->
      <img
        src="assests/images/equipments/dustbin.png"
        alt="Dustbin"
        style="width: 150px; position: relative; z-index: 1;"
      />

      <!-- Fire Extinguisher -->
      <img
        id="extinguisher"
        src="assests/images/equipments/fireextinguisher-no-nozzle.png"
        alt="Fire Extinguisher"
        style="width: 150px; height: auto; margin-top: 50px; transform: translateX(-110px); position: relative;"
      />

      <!-- Clickable handle area -->
      <div id="handle-area" class="handle-area"></div>

      <!-- Nozzle & Spray -->
      <div id="nozzle-container" class="nozzle-container">
        <div class="hose-segment"></div>
        <img src="assests/images/equipments/fire-nozzle.png" class="nozzle" id="nozzle" alt="Nozzle">

        <div id="spray-wrapper" class="spray-wrapper">
          <div id="spray" class="spray"></div>
        </div>

        <div id="success-overlay" class="success-overlay">
          <img src="assests/images/equipments/complete-stamp.png" class="success-stamp" alt="Success">
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div data-include="footer.html"></div>
  </div>

  <script src="static/js/include.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const handleArea = document.getElementById('handle-area');
      const spray = document.getElementById('spray');
      const sprayWrapper = document.getElementById('spray-wrapper');
      const successOverlay = document.getElementById('success-overlay');
      const successStamp = document.querySelector('.success-stamp');

      let holdTimer = null;
      let isHolding = false;

      function setSprayAngle(deg) {
        sprayWrapper.style.transform = `rotate(${deg}deg)`;
      }
      setSprayAngle(110);

      // Start spraying when pressed
      handleArea.addEventListener('mousedown', startSpray);
      handleArea.addEventListener('touchstart', startSpray);

      // Stop spraying when released
      document.addEventListener('mouseup', stopSpray);
      document.addEventListener('touchend', stopSpray);

      function startSpray() {
        if (isHolding) return;
        spray.classList.add('active');

        // Start 3-second hold timer
        holdTimer = setTimeout(() => {
          completeTask();
        }, 2000);
      }

      function stopSpray() {
        spray.classList.remove('active');
        clearTimeout(holdTimer);
      }

      function completeTask() {
        if (isHolding) return;
        isHolding = true;
        spray.classList.remove('active');

        successOverlay.classList.add('show');
        setTimeout(() => successStamp.classList.add('stamped'), 150);

        // Redirect after short delay
        setTimeout(() => {
          window.location.href = 'fireextinguisher-demo4.html';
        }, 2500);
      }
    });
  </script>
</body>
</html>
